<div class="container">
  <div class="header-section">
    <div style="margin-bottom: 15px;">
      <%= image_tag "revenue_rise_logo.png", alt: "Revenue Rise Solutions", class: "logo" %>
      <h1>Revenue Rise Solutions</h1>
    </div>
    <p class="subtitle">Extraction Results</p>
    <p style="color: #707070; font-size: 0.95rem; margin-top: 10px;">OCR text extraction from your referral document</p>
  </div>

  <div class="file-info-card">
    <h3>ğŸ“„ File Information</h3>
    <div class="info-grid">
      <div class="info-item">
        <span class="label">Filename:</span>
        <span class="value"><%= @file_name %></span>
      </div>
      <div class="info-item">
        <span class="label">File Type:</span>
        <span class="value"><%= @file_type %></span>
      </div>
      <div class="info-item">
        <span class="label">Processing Method:</span>
        <span class="value">OCR (Tesseract + PDF Reader)</span>
      </div>
    </div>
  </div>

    <div class="ai-extraction-section">
    <div class="section-header">
      <h3>ğŸ¤– AI Smart Extraction - Structured Medical Data</h3>
      <% if @extracted_fields[:ai_used] %>
        <span class="badge badge-ai">âœ¨ AI-Powered</span>
      <% else %>
        <span class="badge badge-basic">âš¡ Basic Extraction</span>
      <% end %>
    </div>
    
    <% if @extracted_fields[:extraction_notes].present? %>
      <div class="extraction-notes">
        <strong>â„¹ï¸ Note:</strong> <%= @extracted_fields[:extraction_notes] %>
      </div>
    <% end %>
    
    <div class="fields-grid">
      <div class="field-card <%= field_status(@extracted_fields[:patient_name]) %>">
        <div class="field-icon">ğŸ‘¤</div>
        <div class="field-name">Patient Name</div>
        <div class="field-value"><%= display_field(@extracted_fields[:patient_name]) %></div>
      </div>
      
      <div class="field-card <%= field_status(@extracted_fields[:date_of_birth]) %>">
        <div class="field-icon">ğŸ‚</div>
        <div class="field-name">Date of Birth</div>
        <div class="field-value"><%= display_field(@extracted_fields[:date_of_birth]) %></div>
      </div>
      
      <div class="field-card <%= field_status(@extracted_fields[:phone_number]) %>">
        <div class="field-icon">ğŸ“</div>
        <div class="field-name">Phone Number</div>
        <div class="field-value"><%= display_field(@extracted_fields[:phone_number]) %></div>
      </div>
      
      <div class="field-card <%= field_status(@extracted_fields[:email_address]) %>">
        <div class="field-icon">ğŸ“§</div>
        <div class="field-name">Email Address</div>
        <div class="field-value"><%= display_field(@extracted_fields[:email_address]) %></div>
      </div>
      
      <div class="field-card <%= field_status(@extracted_fields[:insurance]) %>">
        <div class="field-icon">ğŸ¥</div>
        <div class="field-name">Insurance</div>
        <div class="field-value"><%= display_field(@extracted_fields[:insurance]) %></div>
      </div>
      
      <div class="field-card <%= field_status(@extracted_fields[:referring_provider]) %>">
        <div class="field-icon">ğŸ‘¨â€âš•ï¸</div>
        <div class="field-name">Referring Provider</div>
        <div class="field-value"><%= display_field(@extracted_fields[:referring_provider]) %></div>
      </div>
      
      <div class="field-card <%= field_status(@extracted_fields[:referral_reason]) %>">
        <div class="field-icon">ğŸ“‹</div>
        <div class="field-name">Referral Reason</div>
        <div class="field-value"><%= display_field(@extracted_fields[:referral_reason]) %></div>
      </div>
      
      <div class="field-card <%= field_status(@extracted_fields[:notes_comments]) %>">
        <div class="field-icon">ğŸ“</div>
        <div class="field-name">Notes/Comments</div>
        <div class="field-value"><%= display_field(@extracted_fields[:notes_comments]) %></div>
      </div>
    </div>
    
    <% if @extracted_fields[:confidence].present? %>
      <div class="confidence-meter">
        <span class="label">Extraction Confidence:</span>
        <span class="confidence-badge confidence-<%= @extracted_fields[:confidence] %>">
          <%= @extracted_fields[:confidence].upcase %>
        </span>
      </div>
    <% end %>
  </div>
  
  <div class="results-card">
    <h3>ğŸ“ Extracted Text</h3>
    <div class="extracted-text">
      <%= simple_format(@extracted_text) %>
    </div>
    <div class="text-stats">
      <span>Character Count: <%= @extracted_text.length %></span>
      <span>Word Count: <%= @extracted_text.split.length %></span>
      <span>Line Count: <%= @extracted_text.lines.count %></span>
    </div>
  </div>

  <div class="actions">
    <%= link_to "â† Upload Another Document", referrals_path, class: "btn btn-secondary" %>
  </div>
</div>
